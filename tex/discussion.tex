\section{Discussion}
\label{sec:matern_discussion}

We have shown the general formulation of the covariance model that is used
to specify the prior within our inverse modelling framework.
A key issue that was addressed here was anisotropic length scales, which is a
common occurrence in geophysical fluid dynamics.
Our formulation involves a mapping that re-scales the Mat\'ern SPDE.
As a result, we must specify the hyperparameters $\rangeh$, $L_y$, and $L_z$
(and we note that at least one more parameter, e.g.\ $L_x$ would be required for
a 3D field).
By selecting $L_y$ and $L_z$ based on the numerical grid, we are able to encode
anisotropy that is already considered when formulating the forward model.
Thus, we are effectively left with a single hyperparameter, $\rangeh$, which can
be thought of as a dial controlling the number of neighboring grid cells across
which variations are correlated.
From a modeller's perspective, this allows for an intuitive specification of
covariance.
Our numerical results show that this intuitive relation coincides with the
Mat\'ern correlation function. \\

These examples illustrate how anisotropy and nonstationarity are intuitively
encoded into this correlation model via the computational grid.
Specifically, the LLC grid defines a refinement at the equator in order to
better resolve tropical zonal currents \cite{forgetECCOv4} \red{that are typically
confined to the upper X hundred meters vertically}.
In terms of spatial statistics, these currents are the reason for
relatively elongated correlation length scales in the zonal direction which are
observed in nature \red{CITE}.
The parameterization presented here simply takes advantage of the correspondence
between the grid definition, motivated by physical processes, and spatial
statistics.

\noindent\textbf{Comparison to \citet{weaver_correlation_2001}.}
In essence, our covariance model has taken the sequence of operations proposed
by \citet{weaver_correlation_2001} and swapped out the differential operator for
the inverse Laplacian-like operator in the Mat\'ern SPDE.
For comparison, the differential model used in their original formulation is
the repeated application of a diffusion operator
\begin{linenomath*}\begin{equation*}
    C_{\text{WC01}} = (I + L)^p \, W^{-1/2} \, ,
\end{equation*}\end{linenomath*}
where $L$ is a discretized Laplacian that can (and usually does) contain a
``diffusion'' tensor, $W = \text{diag}\{V_i\}_{i=1}^{\nuni}$ is a diagonal
matrix of grid cell volume
elements, and $p$ is the number of times the operator is applied.
Note that our use of the notation $C$, $L$, and $p$ is different than what
is used in their work.
We note a few differences that we find advantageous about our approach
compared to this, which we order by importance.
\begin{enumerate}
    \item A crucial aspect of our inverse modelling framework is the adjoint
        model, which is generated by an algorithmic differentiation software
        called TAF \citep{giering2005}. Repeated application of the diffusion
        operator as in $C_{\text{WC01}}$ unfortunately requires the intermediate
        storage of results during its application, due to the
        ``pseudo-timestepping'' nature of the operator.
        On the other hand, the operator developed here, $C = A^{-1}D_z$ is easily
        implemented in an adjoint model as $A$ and $A^{-1}$ are self adjoint.
        As a result, this implementation reduces I/O during the adjoint model,
        which is often the biggest constraint on performance.
    \item The number of pseudo-timesteps, $p$, in $C_{\text{WC01}}$ is
        controlled by the diffusion stability requirement, $p > 2 (l/\Delta
        x)^2$, where $l$ is a length scale associated with the diffusion tensor
        in the operator $L$. In our experience, the number of time steps
        required is usually much greater than this requirement, and as a result
        there is usually a bit of guess work required
        to determine $p$.
        Here, the solution of an inverse elliptic operator is clear - we
        employ an iterative solver that proceeds until a desired
        tolerance is achieved.
    \item It is often the case that the diffusion operator $C_{\text{WC01}}$ is
        applied separately to the vertical and horizontal dimensions, e.g.\
        \citep{moore_regional_2011-1,forgetECCOv4}.
        As noted in \citet{moore_regional_2011-1}, there is no overwhelming
        evidence that enables this assumption, but it is carried out nonetheless
        for computational convenience.
        We note that the scaling procedure developed here avoids this
        assumption entirely.
    \item By defining the covariance model through the inverse of an elliptic
        operator, we have easy access to its inverse through $A$.
        We find that this is useful in formulating the regularization term in an
        inverse problem, in which control vector updates are penalized by
        $C^{-1}$ (see chapter xx, section
        xx for details).
        Applying $A$ rather than
        $A^{-1}$ in an iterative optimization scheme affords a modest
        computational cost savings, and is easy to implement in a large code
        base. We recognize, however, that this cost savings is dwarfed by the
        solution of the coupled set of PDEs in the forward model.
\end{enumerate}

\noindent\textbf{Nonstationarity.}
The mapping method outlined in
sections \ref{sec:matern_review} \& \ref{sec:matern_operator}
open the door to a very general covariance model.
Namely, by allowing $\defjac(\x)$ to vary in space, one can easily encode
nonstationarity into the covariance.
We have neglected to address this issue here, since we have no prior knowledge
that would guide the specification of strong spatial variations into the prior.
Additionally, we found the correlation length scales and random samples to be
indistinguishable when a constant $L_y$ and $L_z$ were used, when compared to
using the grid-scale that weakly varies with latitude.
However, this generalization may be beneficial for global ocean models, since
as an example,
we know \textit{a priori} that spatial scales of variability correlate with
latitude.
For instance, global ocean models often have a refinement at the equator to
represent important small-scale processes there, e.g.\ \citep{forgetECCOv4}.
Additionally, the length scale of baroclinic instabilities varies with latitude
according to the deformation radius (see chapter xx).
Both of these issues are addressed to some degree in the computational grid
of many ocean models, and could easily be incorporated into the Mat\'ern
covariance operator as suggested here.
In future work, we plan to investigate how well the mapping method preserves the
correlation structure in the case of nonstationarity.
