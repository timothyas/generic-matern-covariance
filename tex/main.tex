\documentclass[alpha-refs]{Wiley-LaTeX-Template/wiley-article}

% --- Journal Provided
\usepackage{url}
\usepackage{lineno}
\usepackage{soul}

% --- Custom additions
\usepackage{amsmath, amssymb}
\usepackage{mathtools} % for \coloneqq
\usepackage{color}
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{bm}
\usepackage{adjustbox}
\usepackage[percent]{overpic}

% Definitions
\usepackage{ide}

\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=black,
    urlcolor=black,
    citecolor=black
}
\usepackage[capitalise,noabbrev]{cleveref}

\newcommand{\red}[1]{\textcolor{red}{#1}}
\newcommand{\blue}[1]{\textcolor{blue}{#1}}

% Define some citation abbreviations
\defcitealias{RSSB:RSSB777}{L11}

% --- Header
\title{A Practical Formulation for an Anisotropic and Nonstationary Mat\'ern Class
    Correlation Operator
}
\author[1,2,3]{Timothy A. Smith}

\affil[1]{Cooperative Institute for Research in Environmental Sciences
    (CIRES) at the University of Colorado Boulder, Boulder, CO, USA
}
\affil[2]{Physical Sciences Laboratory (PSL), National Oceanic and
    Atmospheric Administration (NOAA), Boulder, CO, USA
}
\affil[3]{Oden Institute for Computational Engineering and Sciences,
    The University of Texas at Austin, Austin, TX, USA
}

\corraddress{Timothy A. Smith, David Skaggs Research Center, Boulder, CO, 80305,
    USA
}
\corremail{tim.smith@noaa.gov}

\fundinginfo{This work was funded in part by
    NASA NNH19ZDA001N-SLCST
    and a JPL/Caltech Subcontract (ECCO Consortium)
}

\runningauthor{Smith}

\begin{document}

\maketitle
\begin{abstract}
    A key component of data assimilation methods is the specification of
    univariate spatial correlations, which appear in the background-error
    covariance.
    For realistic problems in meteorology and oceanography,
    correlation length scales are nonstationary (variable in space) and
    anisotropic (variable in each direction).
    Variational approaches typically use an operator to enforce correlation
    length scales, and thus the operator must be designed to capture
    desired levels of nonstationarity and anisotropy.
    For systems with complex boundaries, such as the ocean, it is natural
    to use a filtering approach based on the application of an elliptic,
    Laplacian-like operator.
    Here we show how an elliptic operator can be formulated to capture a general
    Mat\'ern-type correlation structure.
    We show how nonstationarity and anisotropy can be encoded into the operator
    via a simple change of variables based on user-defined
    normalization length scales.
    The change of variables defines a mapping between the computational domain
    and a space where the analytical Mat\'ern correlation function
    applies.
    In addition to the mapping, two other hyperparameters \textit{separately}
    control the correlation length scale (i.e.\ range) and shape.
    As a practical use-case, we apply the operator to a global ocean model.
    We show that when the normalizing length scales correspond to the local grid
    scale, the range parameter has an intuitive
    interpretation as the number of neighboring grid cells at which correlation drops to 0.14.
    Finally, the correlation model is shown to be computationally efficient in
    two regards.
    First, the necessary linear solve can be performed with a high tolerance
    ($\sim10^{-3}$) while still achieving the correct statistics, requiring
    few iterations to converge.
    Secondly, the operator's exponent, which controls the correlation shape,
    is linearly related to the diagonal elements of its matrix representation.
    As a result, using an exponent greater than one can improve convergence
    properties.
    Thus, the framework provides flexibility in controlling correlation shape.

\keywords{correlation operators, covariance modelling, background error,
    ocean data assimilation, variational assimilation, stochastic PDEs}
\end{abstract}

\linenumbers

\input{intro.tex}

\input{review.tex}

\input{hyperparameters.tex}

\input{llc90.tex}

\input{discussion.tex}

\appendix
\input{discretization.tex}

\input{block_sor.tex}

\section*{Acknowledgements}
This study used the MITgcm \citep{campin_mitgcmmitgcm_2021}, with modifications
that can be found at \url{github.com/timothyas/MITgcm/tree/matern-correlation}, for solving the
presented linear system on the LLC grid.
The grid files that make up the LLC grid can be found with the ECCOv4 data,
which were accessed at \citep{ecco_v4r2}.
The python packages \texttt{xmitgcm} \citep{abernathey_2021_5139886},
\texttt{xarray} \citep{hoyer2017xarray}, \texttt{dask} \citep{dask}, and
\texttt{zarr} \citep{alistair_miles_2020_3773450}
were essential for postprocessing and analyzing the results.
I am grateful to Vikram Garg early discussions on the
work by \citet{RSSB:RSSB777}.
I thank Patrick Heimbach, Michael Diamond, Michael MacFerrin, and Fangfang Yao
for comments which improved the manuscript.
%, as well as Jemima Tabeart for introducing me to
%the implicit diffusion developments by \citep{mirouze_representation_2010}
%cited throughout the paper.

\bibliography{references}
\end{document}
